var x$;x$=angular.module("webedit"),x$.controller("profile",["$scope","$http","ldNotify"].concat(function(t,n,e){return t.page={"delete":function(e){return n({url:"/d/page/"+e+"/",method:"DELETE"}).then(function(){return t.docs=t.docs.filter(function(t){return t.slug!==e})})}},n({url:"/d/me/doc/",method:"GET"}).then(function(n){return t.docs=n.data,t.docs.map(function(t){return t.timestamp=new Date(t.modifiedtime||t.createdtime).getTime(),t.thumbnail?t.thumbnail=t.thumbnail.replace(/\/\d+x\d+\//,"/80x42/"):void 0}),t.docs.sort(function(t,n){return n.timestamp-t.timestamp})}),t.page={thumbnail:function(n){var e,a;return e="1024x1024",a=uploadcare.openDialog(null,null,{imageShrink:e,crop:"free"}),a.done(function(e){var a,u;return a=((u=e.files)?u():[e])[0],t.$apply(function(){return n.thumbnailLoading=!0}),a.done(function(e){return t.$apply(function(){return n.thumbnail=e.cdnUrl+"",n.thumbnailLoading=!1,t.page.update(n)})})})},update:function(a,u){return null==u&&(u=!1),t.loading=!0,n({url:"/d/page/"+a.slug+"/",method:"PUT",data:{title:a.title,thumbnail:a.thumbnail,domain:a.domain,path:a.path,gacode:a.gacode}})["finally"](function(){return t.loading=!0}).then(function(){return t.loading=!1,u&&(a.toggled=!1),e.send("success","saved.")})["catch"](function(){return alert("failed to save. try again later")})}}}));